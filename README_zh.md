# 自定义分享域名插件

一个功能强大的 Blinko 插件，允许用户自定义分享链接域名，支持多域名管理、密码保护和直观的分享界面。

[English](README.md) | 中文说明


## ✨ 功能特性

- 🔗 **多域名管理** - 添加和管理多个自定义域名
- 🔐 **密码保护** - 使用6位数字密码保护分享内容
- 🎯 **智能域名选择** - 交互式界面选择分享域名
- 🏠 **默认域名设置** - 设置自动分享时使用的首选域名
- 🛡️ **协议智能处理** - 智能处理 HTTPS/HTTP 协议
- 📤 **高级分享选择器** - 丰富的UI界面，支持域名选项和复制功能
- 💾 **持久化存储** - 所有设置本地保存，支持状态管理
- 🔄 **旧版迁移** - 从单域名配置无缝升级
- 🌍 **国际化支持** - 完整支持中文和英文界面
- ❌ **分享管理** - 一键取消现有分享

## 🚀 安装方式

### 标准安装
1. 从发布页面下载插件包
2. 在 Blinko 管理界面中上传插件
3. 启用插件并配置您的域名
4. 开始使用自定义域名分享！

### API直接安装（无需审核）
除了标准安装方式外，还支持通过API直接安装插件，无需等待审核流程。

详细的API安装说明请参阅 [API文档](API.md)。

## 📖 使用指南

### 域名管理

1. **访问设置**：打开插件设置面板
2. **添加域名**：点击"添加域名"创建新的自定义域名
3. **配置域名**：
   - 输入友好名称（如"我的博客"）
   - 输入域名URL（协议可选 - 自动添加HTTPS）
   - 根据需要启用/禁用
4. **设置默认**：选择自动分享时使用的默认域名
5. **保存设置**：应用您的配置

### 自定义域名分享

1. **右键点击** 任意笔记或闪念
2. **选择** 右键菜单中的"分享到自定义域名"
3. **配置分享选项**：
   - 开启/关闭密码保护
   - 输入6位数字密码或生成随机密码
   - 点击"生成分享链接"创建分享
4. **选择域名**：从可用域名中选择（原始域名 + 自定义域名）
5. **复制链接**：点击任意域名选项复制分享链接
6. **管理分享**：使用"取消分享"撤销访问权限

### 密码保护

- **6位数字界面**：易于使用的密码输入，支持自动焦点切换
- **随机生成**：一键生成随机密码
- **状态持久化**：会话间记住密码设置
- **安全分享**：为敏感内容提供密码保护链接

## 🔧 配置选项

### 域名设置
- **域名名称**：域名的友好标识符
- **域名URL**：完整的域名地址（无协议时自动添加HTTPS）
- **启用状态**：控制域名是否可用于分享
- **默认域名**：设置自动分享时的首选域名

### 分享设置
- **密码保护**：为分享内容设置可选的6位数字密码
- **分享状态管理**：跨会话的持久分享状态
- **链接生成**：集成官方 Blinko API 确保安全分享

### 协议处理
- **智能检测**：保留用户指定的 HTTP/HTTPS 协议
- **自动HTTPS**：未指定协议时自动添加HTTPS
- **灵活支持**：同时支持 HTTP 和 HTTPS 域名

## 🔄 迁移与兼容性

插件提供从旧版本的无缝迁移：
- **自动检测**：自动检测旧版单域名配置
- **无缝升级**：迁移到新的多域名格式，无数据丢失
- **设置保留**：维护所有用户偏好和配置
- **向后兼容**：与现有 Blinko 安装兼容

## 🌍 国际化

完整的本地化支持：
- **简体中文 (zh)** - 完整的中文界面
- **English (en)** - 完整的英文界面
- **动态切换** - 跟随 Blinko 的语言设置
- **可扩展** - 易于添加更多语言

## 🛠️ 技术细节

### 架构
- **前端**：使用 TypeScript 的 Preact，确保类型安全
- **构建系统**：Vite 用于快速开发和优化构建
- **状态管理**：React hooks 用于组件状态
- **API集成**：官方 Blinko API 用于分享管理
- **存储**：Blinko 的插件配置系统

### 文件结构
```
src/
├── index.tsx           # 主插件入口点
├── setting.tsx         # 设置面板组件
├── share-selector.tsx  # 分享选择界面
├── utils.ts           # 工具函数和API调用
├── types.ts           # TypeScript 类型定义
└── locales/           # 国际化文件
    ├── en.json        # 英文翻译
    └── zh.json        # 中文翻译
```

### API集成
- **分享创建**：`window.Blinko.api.notes.shareNote.mutate()`
- **分享取消**：通过API取消现有分享
- **配置管理**：`window.Blinko.api.config` 用于设置持久化
- **消息通知**：`window.Blinko.toast` 用于用户反馈

## 📋 更新日志

### v1.0.0 (最新版)
- ✨ **新增**：多域名管理系统
- ✨ **新增**：6位数字密码保护界面
- ✨ **新增**：高级分享选择器，支持域名选项
- ✨ **新增**：分享状态持久化和管理
- ✨ **新增**：取消分享功能
- ✨ **新增**：智能协议处理（HTTP/HTTPS）
- ✨ **新增**：完整国际化支持（中英文）
- ✨ **新增**：旧版配置迁移
- 🔧 **改进**：域名验证和URL处理
- 🔧 **改进**：响应式UI设计，处理溢出问题
- 🔧 **改进**：错误处理和用户反馈
- 🐛 **修复**：小屏幕上的链接溢出问题
- 🐛 **修复**：自定义协议的域名替换逻辑

## 🤝 贡献

我们欢迎为改进此插件做出贡献：

1. **Fork** 仓库
2. **创建** 功能分支 (`git checkout -b feature/amazing-feature`)
3. **提交** 更改 (`git commit -m 'Add amazing feature'`)
4. **推送** 到分支 (`git push origin feature/amazing-feature`)
5. **打开** Pull Request

### 开发环境设置
```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 生产构建
npm run build

# 类型检查
npm run type-check

# 发布插件
npm run release:publish
```

## 📝 插件信息

- **版本**: 1.0.0
- **作者**: Manus
- **许可证**: MIT
- **最低 Blinko 版本**: 0.0.0
- **插件ID**: custom-share-domain-plugin
- **仓库地址**: https://github.com/xiaobaiweinuli/custom-share-domain-plugin

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件。

## 🙏 致谢

- 感谢 Blinko 团队提供优秀的插件系统
- 社区反馈和功能请求
- 所有帮助改进此插件的贡献者

---


**为 Blinko 社区用 ❤️ 制作**

